<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/_page-layout}">
<head>
    <title>Announcements</title>

    <!-- Plugins css -->
    <link th:href="@{/libs/quill/quill.core.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/libs/quill/quill.bubble.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/libs/quill/quill.snow.css}" rel="stylesheet" type="text/css"/>

    <!-- Custom Css -->
    <style>
        .custom-overlay {
            transition: all 0.4s ease-in-out;
            opacity: 0;
        }

        .box:hover .custom-overlay {
            opacity: 1;
        }

        .custom-overlay.hidden {
            opacity: 0;
            pointer-events: none; /* Disable pointer events when hidden */
        }
    </style>
</head>

<div layout:fragment="main">
    <div class="modal fade" id="custom-modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
         role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-light">
                    <h4 class="modal-title" id="custom-title" style="width: 90%">
                        <label for="title">Title:</label>
                        <input type="text" id="title" name="title" oninput="this.size = this.value.length"
                               style="margin-left: 5px; max-width: 90%; min-width: 206px" disabled>
                    </h4>
                    <button type="button" class="btn btn-danger waves-effect waves-light" data-bs-dismiss="modal"
                            aria-hidden="true" onclick="clearEditorContent()"><i class="mdi mdi-close"></i></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="row">
                            <div class="col-xl-12">
                                <div class="card">
                                    <div class="card-body">
                                        <ul class="nav nav-tabs">
                                            <li class="nav-item">
                                                <a id="view-announcement-tab" href="#view-announcement"
                                                   data-bs-toggle="tab" aria-expanded="false"
                                                   class="nav-link active" onclick="toggleTitleEditing()">
                                                    View announcement
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a id="edit-announcement-tab" href="#edit-announcement"
                                                   data-bs-toggle="tab" aria-expanded="true"
                                                   class="nav-link" onclick="toggleTitleEditing()">
                                                    Edit announcement
                                                </a>
                                            </li>
                                        </ul>

                                        <div class="tab-content">
                                            <div class="tab-pane show active" id="view-announcement">
                                                <div class="col-12">
                                                    <div class="card">
                                                        <div class="card-body">
                                                            <div id="bubble-editor"></div> <!-- end Snow-editor-->
                                                        </div> <!-- end card-body-->
                                                    </div> <!-- end card-->
                                                </div><!-- end col -->
                                            </div>

                                            <div class="tab-pane" id="edit-announcement">
                                                <div class="col-12">
                                                    <div class="card">
                                                        <div class="card-body">
                                                            <div id="snow-editor">
                                                                <h3>Your announcement content here...</h3>
                                                            </div> <!-- end Snow-editor-->
                                                        </div> <!-- end card-body-->
                                                    </div> <!-- end card-->
                                                </div><!-- end col -->
                                            </div>

                                            <div id="publish-button-div" style="text-align: center;">
                                                <button type="button" class="btn btn-success waves-effect waves-light">
                                                    Publish now
                                                    <span class="btn-label-right"><i
                                                            class="mdi mdi-18px mdi-publish"></i></span>
                                                </button>
                                            </div>
                                            <div id="update-button-div" style="text-align: center;">
                                                <button type="button" class="btn btn-info waves-effect waves-light">
                                                    Update
                                                    <span class="btn-label-right"><i
                                                            class="mdi mdi-18px mdi-update"></i></span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div> <!-- end card-->
                            </div> <!-- end col -->
                        </div> <!-- end row -->
                    </form>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

    <button class="btn btn-lg font-16 btn-success" id="btn-new-event" data-bs-toggle="modal"
            data-bs-target="#custom-modal" onclick="expandEditAnnouncementTab(); announcementType='new'">
        <i class="fa fa-plus me-1"></i> Create new
    </button>

    <div class="row">
        <div class="col-sm-12">
            <div class="timeline">
                <article class="timeline-item alt">
                    <div class="time-show">
                        <a class="btn btn-purple width-lg" style="pointer-events: none">Today</a>
                    </div>
                </article>

                <article class="timeline-item alt">
                    <div class="timeline-desk">
                        <div class="panel box" onmouseover=showButtonsDiv("buttons-div-1")
                             onmouseout=hideButtonsDiv("buttons-div-1")>
                            <div class="panel-body">
                                <span class="arrow-alt"></span>
                                <span class="timeline-icon bg-purple"><i class="mdi mdi-circle"></i></span>
                                <h4>Announcement title here</h4>
                                <p class="text-purple mt-1">1 hour ago</p>
                                <p class="timeline-date text-muted"><small>08:25 am</small></p>
                                <div id="buttons-div-1" class="custom-overlay hidden"
                                     style="float: right;margin-top: 10px;">
                                    <button type="button"
                                            class="btn btn-sm btn-info waves-effect waves-light rounded-pill"
                                            data-bs-toggle="modal" data-bs-target="#custom-modal"
                                            onclick="expandViewAnnouncementTab(); announcementType='update'">View
                                    </button>
                                    &nbsp;
                                    <button type="button"
                                            class="btn btn-sm btn-danger waves-effect waves-light rounded-pill">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <article class="timeline-item">
                    <div class="timeline-desk">
                        <div class="panel box" onmouseover=showButtonsDiv("buttons-div-2")
                             onmouseout=hideButtonsDiv("buttons-div-2")>
                            <div class="panel-body">
                                <span class="arrow"></span>
                                <span class="timeline-icon bg-purple"><i class="mdi mdi-circle"></i></span>
                                <h4>Announcement title here</h4>
                                <p class="text-purple mt-1">1 hour ago</p>
                                <p class="timeline-date text-muted" style="margin-top: 10px"><small>08:25 am</small></p>
                                <div id="buttons-div-2" class="custom-overlay hidden"
                                     style="float: left; margin-top: 10px">
                                    <button type="button"
                                            class="btn btn-sm btn-info waves-effect waves-light rounded-pill"
                                            data-bs-toggle="modal" data-bs-target="#custom-modal"
                                            onclick="expandViewAnnouncementTab(); announcementType='update'">View
                                    </button>
                                    &nbsp;
                                    <button type="button"
                                            class="btn btn-sm btn-danger waves-effect waves-light rounded-pill">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <article class="timeline-item alt">
                    <div class="time-show">
                        <a class="btn btn-warning width-lg" style="pointer-events: none">Yesterday</a>
                    </div>
                </article>

                <article class="timeline-item alt">
                    <div class="timeline-desk">
                        <div class="panel box" onmouseover=showButtonsDiv("buttons-div-3")
                             onmouseout=hideButtonsDiv("buttons-div-3")>
                            <div class="panel-body">
                                <span class="arrow-alt"></span>
                                <span class="timeline-icon bg-warning"><i class="mdi mdi-circle"></i></span>
                                <h4>Announcement title here</h4>
                                <p class="text-warning mt-1">07 January 2016</p>
                                <p class="timeline-date text-muted"><small>08:25 am</small></p>
                                <div id="buttons-div-3" class="custom-overlay hidden"
                                     style="float: right; margin-top: 10px">
                                    <button type="button"
                                            class="btn btn-sm btn-info waves-effect waves-light rounded-pill"
                                            data-bs-toggle="modal" data-bs-target="#custom-modal"
                                            onclick="expandViewAnnouncementTab(); announcementType='update'">View
                                    </button>
                                    &nbsp;
                                    <button type="button"
                                            class="btn btn-sm btn-danger waves-effect waves-light rounded-pill">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <article class="timeline-item">
                    <div class="timeline-desk">
                        <div class="panel box" onmouseover=showButtonsDiv("buttons-div-4")
                             onmouseout=hideButtonsDiv("buttons-div-4")>
                            <div class="panel-body">
                                <span class="arrow"></span>
                                <span class="timeline-icon bg-warning"><i class="mdi mdi-circle"></i></span>
                                <h4>Announcement title here</h4>
                                <p class="text-warning mt-1">07 January 2016</p>
                                <p class="timeline-date text-muted" style="margin-top: 10px"><small>08:25 am</small></p>
                                <div id="buttons-div-4" class="custom-overlay hidden"
                                     style="float: left; margin-top: 10px">
                                    <button type="button"
                                            class="btn btn-sm btn-info waves-effect waves-light rounded-pill"
                                            data-bs-toggle="modal" data-bs-target="#custom-modal"
                                            onclick="expandViewAnnouncementTab(); announcementType='update'">View
                                    </button>
                                    &nbsp;
                                    <button type="button"
                                            class="btn btn-sm btn-danger waves-effect waves-light rounded-pill">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <article class="timeline-item alt">
                    <div class="timeline-desk">
                        <div class="panel box" onmouseover=showButtonsDiv("buttons-div-5")
                             onmouseout=hideButtonsDiv("buttons-div-5")>
                            <div class="panel-body">
                                <span class="arrow alt"></span>
                                <span class="timeline-icon bg-warning"><i class="mdi mdi-circle"></i></span>
                                <h4>Announcement title here</h4>
                                <p class="text-warning mt-1">07 January 2016</p>
                                <p class="timeline-date text-muted"><small>08:25 am</small></p>
                                <div id="buttons-div-5" class="custom-overlay hidden"
                                     style="float: right; margin-top: 10px">
                                    <button type="button"
                                            class="btn btn-sm btn-info waves-effect waves-light rounded-pill"
                                            data-bs-toggle="modal" data-bs-target="#custom-modal"
                                            onclick="expandViewAnnouncementTab(); announcementType='update'">View
                                    </button>
                                    &nbsp;
                                    <button type="button"
                                            class="btn btn-sm btn-danger waves-effect waves-light rounded-pill">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <article class="timeline-item alt">
                    <div class="time-show">
                        <a class="btn btn-pink width-lg" style="pointer-events: none">Last Month</a>
                    </div>
                </article>

                <article class="timeline-item">
                    <div class="timeline-desk">
                        <div class="panel box" onmouseover=showButtonsDiv("buttons-div-6")
                             onmouseout=hideButtonsDiv("buttons-div-6")>
                            <div class="panel-body">
                                <span class="arrow"></span>
                                <span class="timeline-icon bg-pink"><i class="mdi mdi-circle"></i></span>
                                <h4>Announcement title here</h4>
                                <p class="text-pink mt-1">31 December 2015</p>
                                <p class="timeline-date text-muted" style="margin-top: 10px"><small>08:25 am</small></p>
                                <div id="buttons-div-6" class="custom-overlay hidden"
                                     style="float: left; margin-top: 10px">
                                    <button type="button"
                                            class="btn btn-sm btn-info waves-effect waves-light rounded-pill"
                                            data-bs-toggle="modal" data-bs-target="#custom-modal"
                                            onclick="expandViewAnnouncementTab(); announcementType='update'">View
                                    </button>
                                    &nbsp;
                                    <button type="button"
                                            class="btn btn-sm btn-danger waves-effect waves-light rounded-pill">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <article class="timeline-item alt">
                    <div class="timeline-desk">
                        <div class="panel box" onmouseover=showButtonsDiv("buttons-div-7")
                             onmouseout=hideButtonsDiv("buttons-div-7")>
                            <div class="panel-body">
                                <span class="arrow-alt"></span>
                                <span class="timeline-icon bg-pink"><i class="mdi mdi-circle"></i></span>
                                <h4>Announcement title here</h4>
                                <p class="text-pink mt-1">31 December 2015</p>
                                <p class="timeline-date text-muted"><small>08:25 am</small></p>
                                <div id="buttons-div-7" class="custom-overlay hidden"
                                     style="float: right; margin-top: 10px">
                                    <button type="button"
                                            class="btn btn-sm btn-info waves-effect waves-light rounded-pill"
                                            data-bs-toggle="modal" data-bs-target="#custom-modal"
                                            onclick="expandViewAnnouncementTab(); announcementType='update'">View
                                    </button>
                                    &nbsp;
                                    <button type="button"
                                            class="btn btn-sm btn-danger waves-effect waves-light rounded-pill">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
        </div>
    </div>
    <!-- end row -->

    <!-- Plugins js -->
    <script th:src="@{/libs/quill/quill.min.js}"></script>
    <script th:src="@{/libs/moment/min/moment.min.js}"></script>

    <!-- Init js -->
    <script th:src="@{/js/pages/form-quilljs.init.js}"></script>

    <!-- Custom script -->
    <script>
        // Variable that stores the type of the announcement (new or update).
        let announcementType;

        // Change page title.
        const pageTitle = document.getElementsByClassName("page-title-main");
        pageTitle[0].textContent = "Announcements";

        // Disable the editor of the view announcement.
        const editors = document.getElementsByClassName("ql-editor");
        editors[0].setAttribute("contenteditable", "false");

        // Function that expands the edit announcement tab.
        function expandEditAnnouncementTab() {
            const editAnnouncementTab = document.getElementById("edit-announcement-tab");
            const viewAnnouncementTab = document.getElementById("view-announcement-tab");
            const editAnnouncementTabContent = document.getElementById("edit-announcement");
            const viewAnnouncementTabContent = document.getElementById("view-announcement");
            const title = document.getElementById("title");

            editAnnouncementTab.setAttribute("aria-expanded", "true");
            editAnnouncementTab.classList.add("active");
            editAnnouncementTabContent.classList.add("show", "active");
            viewAnnouncementTab.setAttribute("aria-expanded", "false");
            viewAnnouncementTab.classList.remove("active");
            viewAnnouncementTabContent.classList.remove("show", "active");
            title.removeAttribute("disabled");

            showPublishButton();
        }

        // Function that expands the view announcement tab.
        function expandViewAnnouncementTab() {
            const editAnnouncementTab = document.getElementById("edit-announcement-tab");
            const viewAnnouncementTab = document.getElementById("view-announcement-tab");
            const editAnnouncementTabContent = document.getElementById("edit-announcement");
            const viewAnnouncementTabContent = document.getElementById("view-announcement");
            const title = document.getElementById("title");

            editAnnouncementTab.setAttribute("aria-expanded", "false");
            editAnnouncementTab.classList.remove("active");
            editAnnouncementTabContent.classList.remove("show", "active");
            viewAnnouncementTab.setAttribute("aria-expanded", "true");
            viewAnnouncementTab.classList.add("active");
            viewAnnouncementTabContent.classList.add("show", "active");
            title.setAttribute("disabled", "true");

            showUpdateButton();
        }

        // Function that shows publish button.
        function showPublishButton() {
            const publishButtonDiv = document.getElementById("publish-button-div");
            const updateButtonDiv = document.getElementById("update-button-div");

            publishButtonDiv.style.display = "block";
            updateButtonDiv.style.display = "none";
        }

        // Function that shows update button.
        function showUpdateButton() {
            const publishButtonDiv = document.getElementById("publish-button-div");
            const updateButtonDiv = document.getElementById("update-button-div");

            publishButtonDiv.style.display = "none";
            updateButtonDiv.style.display = "block";
        }

        // Function that enable/disable editing of an announcement title.
        function toggleTitleEditing() {
            const title = document.getElementById("title");

            if (title.hasAttribute("disabled")) {
                title.removeAttribute("disabled");
            } else {
                title.setAttribute("disabled", "true");
                // Copy the content of the edit announcement editor to the view announcement editor.
                editors[0].innerHTML = editors[1].innerHTML;
            }
        }

        // Function that shows the buttons-div.
        function showButtonsDiv(id) {
            const buttonsDiv = document.getElementById(id);
            buttonsDiv.classList.remove("hidden");
        }

        // Function that hides the buttons-div.
        function hideButtonsDiv(id) {
            const buttonsDiv = document.getElementById(id);
            buttonsDiv.classList.add("hidden");
        }

        // Function that clear the content of the editor.
        function clearEditorContent() {
            const title = document.getElementById("title");
            title.value = "";
            title.removeAttribute("size"); // Reset the size of the input.
            editors.forEach(function (item) {
                item.innerHTML = "<h3>Your announcement content here...</h3>";
            });
        }
    </script>
</div>
</html>